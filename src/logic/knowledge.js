/*******************
 *    KNOWLEDGE    *
 *******************/

export let knowledge = [
    {
        'id': 'tutorial',
        'content': {
            'title': "Omnia, votre Oasis interactif.",
            'text': "Bienvenue dans Omnia, le jeu te permettant de gérer l’écosystème d’une oasis : une zone fertile menacée par le désert. Nous avons besoin de toi!" +
                "\n\nTa mission sera de comprendre à travers le jeu, les différents mécanismes mis au point par la nature et les hommes pour réguler un écosystème." +
                "\n\nCes connaissances te seront très utiles pour ta vie future,\nlorsque tu seras confronté au grand défi climatique." +
                "\n\n\nAu centre de l’écran se trouve ton oasis. Les cases bleues représentent de l’eau, les jaunes le désert, les vertes de la terre fertile sur laquelle tu pourras notamment planter de la végétation ou l’utiliser comme agriculture. Les maisons représentent les habitants, les cactus et palmiers représentent l’agriculture et les autres arbres la végétation." +
                "\n\nEn haut se trouvent les points d’écosystème (la capacité à planter de la végétation) et de civilisation (la capacité à\npratiquer l’agriculture et augmenter le nombre d’habitants). Ce sont les ressources à ta disposition pour avancer dans le jeu." +
                "\n\nEn bas, un menu te permettra de sélectionner un “objet” à poser sur tes cases. Un clic droit avec ta souris permet de\ndéselectionner. Tu peux poser de l’agriculture, de la végétation ou une habitation. Le bulldozer te permet de détruire un objet sur une case. Toutes ces actions, nécessaires à la gestion de l’oasis, te coûtent des ressources. N’en abuse pas!" +
                "\n\nA droite, tu trouveras des informations supplémentaires sur\nton oasis : le nombre d’habitations, de champs agricoles, de végétations, ainsi que le nombre de cases impactées par des problèmes et l’événement naturel en cours." +
                "\n\nAu fur et à mesure du jeu, des connaissances apparaîtront au centre de ton écran. Si tu ne sais plus ce qu’il faut retenir, tu pourras les consulter dans le menu à gauche." +
                "\n\n\nSois attentif : de temps en temps tu rencontreras des problèmes dans certaines zones de ton oasis, comme un incendie, une perte de fertilité ou une maladie. Pour les régler, il faudra que tu cliques sur l’icône les représentant! Cela te coûtera évidemment des ressources." +
                "\n\nLa nature est capricieuse et quelques fois, elle te le fera\nsavoir. Prend garde aux tempêtes de sable et à la sécheresse!" +
                "\n\nUne case qui atteint une valuation nulle devient une case désertique, et perd l’objet qui se trouve dessus. Un objet qui atteint une valuation nulle disparaît de la carte." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'missingVegetation',
        'content': {
            'title': "Manque de végétation",
            'text': "Une végétation importante est capitale dans une\noasis. Elle permet notamment de réguler la température, en amenant l’eau de la nappe phréatique à la surface." +
                "\n\nDe plus, lorsque les plantes respirent, elles rejettent de l’eau dans l’atmosphère. Dans le cycle de l’eau, cette eau permet de former des nuages, qui vont à leur tour provoquer de la pluie, nourrissant les plantes…" +
                "\n\nDans le jeu, un manque de végétation provoque une perte de valuation des cases fertiles." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'addingFertile',
        'content': {
            'title': "Expansion de la nappe phréatique",
            'text': "Bonne nouvelle, la nappe phréatique se régénère. De nouvelles terres fertiles apparaîtront au cours du temps, permettant de développer votre écosystème et civilisation. Continuez à maintenir l’équilibre!" +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'excessiveFarming',
        'content': {
            'title': "Agriculture excessive",
            'text': "Attention à l’excès d’agriculture! L’eau est une ressource limitée, utilisée notamment pour irriguer les champs. Trop d’agriculture diminue vos réserves en eau, ainsi que la fertilité des sols, vulnérables à la sécheresse." +
                "\n\nDans le jeu, cela correspond à une perte de valuation des cases fertiles." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'balanceFarming',
        'content': {
            'title': "Déséquilibre entre agriculture et habitations",
            'text': "Veillez à l’équilibre entre votre agriculture et les habitations. En effet, si votre oasis a trop peu d’agriculture par rapport aux habitations, les habitants auront du mal à se nourrir. Dans le jeu, cela se traduit par une perte de valuation des habitations." +
                "\n\nInversement, si votre oasis a trop peu d’habitations par rapport aux champs, l’entretien de l’agriculture sera difficile. Dans le jeu, cela se traduit par\nune perte de valuation des champs." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'farawayHouse',
        'content': {
            'title': "Isolation en plein désert",
            'text': "Vous venez de placer une habitation trop éloignée du point d’eau! Dans un désert, la végétation, l’agriculture ainsi que la population ne peuvent survivre sans source d’eau à proximité." +
                "\n\nEssayez donc de ne pas placer vos habitations trop loin du point d’eau, et de favoriser la plantation d’arbres et l’expansion de l’agriculture sur les zones fertiles." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'decreaseSoil',
        'content': {
            'title': "Défertilisation des sols",
            'text': "Attention, les sols fertiles se dégradent! À cause du manque crucial de matière organique dans les sols\nd’une oasis, il devient nécessaire de les fertiliser, et ce assez souvent. En effet, ce type d’événement est perpétuel et est lié au climat et à l’environnement." +
                "\n\nPlusieurs causes sont liées à la perte de fertilité. La première est l’agriculture, qui puise beaucoup dans les ressources des sols, les endommageant par la même occasion. La seconde est la sécheresse et l’aridité qui contribue également à l’assèchement des sols. Des engrais et une irrigation optimale permet de réduire les dégâts." +
                "\n\nPour corriger le problème, rien de plus simple, il vous suffit de cliquer sur la bulle ayant une icône en forme de goutte d’eau. Les cases voisines seront également refertilisées." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'fire',
        'content': {
            'title': "Vulnérabilité face aux incendies",
            'text': "Un incendie s’est déclaré dans votre oasis! Il faut vite l’éteindre avant qu’il ne se propage!" +
                "\n\nDû à la forte chaleur et aux activités liées à l’homme, certains incendies peuvent survenir et décimer de nombreux arbres et habitations. L’écosystème entier est donc très vulnérable face à ce type d'événement, et ne pas s’en occuper peut signifier la fin d’une l’oasis." +
                "\n\nPour arroser le feu, rien de plus simple, il vous suffit de cliquer sur la bulle ayant une icône en forme de flamme!" +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'illness',
        'content': {
            'title': "Propagation des maladies",
            'text': "Un des habitants de votre oasis est malade. Il faut vite s’en occuper avant que la maladie ne se propage! Les habitants dans les oasis sont en général peu nombreux mais très communautaires, donc la propagation des virus et autres maladies y est forte..." +
                "\n\nLes oasis sont également des lieux qui disposent en général d’une couverture sanitaire médiocre… En cas de maladie grave, les habitants doivent souvent voyager plusieurs dizaines d’heures, voire des jours, pour aller à l’hôpital de la ville ou du village le plus proche." +
                "\n\nPour soigner ce fameux individu, rien de plus simple, il vous suffit de cliquer sur la bulle ayant\nune icône en forme de tête verte!" +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'sandstorm',
        'content': {
            'title': "Les tempêtes de sable",
            'text': "Oh non, une tempête de sable approche à l’horizon! Les risques d’ensablement et de désertification sont accrus et les zones sableuses vont proliférer…" +
                "\n\nEn effet, le vent est l’un des pires ennemis des oasis et ses déplacements sur les sols mal entretenus font des ravages." +
                "\n\nD’autant plus que les habitations isolées sont encore plus fragiles face à ce phénomène." +
                "\n\nMalheureusement ce phénomène n’est pas atténuable\net surgit indépendamment des facteurs contrôlables dans une oasis." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'heatwave',
        'content': {
            'title': "Les fortes chaleurs",
            'text': "Oh non, un épisode de très forte chaleur s’abat sur votre oasis! Les risques de sécheresse, d’évaporation de l’eau, et même des incendies sont accrus." +
                "\n\nEn effet, un désert est très souvent soumis à des vagues de chaleur, fragilisant grandement son écosystème. Pour lutter contre les effets néfastes de celle-ci, le mieux est de planter plus d’arbres afin de maintenir un certain équilibre." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'rain',
        'content': {
            'title': "Les pluies dans le désert",
            'text': "Miracle, il pleut! La sécheresse et les besoins d’eau\npour l’agriculture diminuent fortement." +
                "\n\nEn effet, lorsqu’une pluie tombe dans le désert, un temps agréable s'installe, permettant à la végétation\nde survivre et à la nappe phréatique de se réapprovisionner en eau." +
                "\n\nLes pluies dans le désert sont également très rares, et peuvent ne pas se présenter pendant plusieurs années." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'firstEndgame',
        'content': {
            'title': "L'écosystème s'effondre...",
            'text': "Malheureusement, vous n’avez plus ni assez de ressource pour ajouter de la végétation, ni assez de végétation pour produire de cette ressource." +
                "\n\nVous avez perdu..." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'secondEndgame',
        'content': {
            'title': "La civilisation s'effondre...",
            'text': "Malheureusement, vous n’avez plus ni assez de ressource pour ajouter des habitations ou de l’agriculture, ni assez de ces éléments pour produire de cette ressource." +
                "\n\nVous avez perdu..." +
                "\n\n\n\n"
        },
        'viewed': false
    },
    {
        'id': 'thirdEndgame',
        'content': {
            'title': "Assèchement complet de la nappe phréatique",
            'text': "Malheureusement, la nappe phréatique qui alimentait votre oasis s’est trop asséchée pour permettre la plantation d’arbres ou la fertilisation des sols." +
                "\n\nVous avez perdu..." +
                "\n\n\n\n"
        },
        'viewed': false
    }
];


/*******************
 *    FUNCTIONS    *
 *******************/

/**
 * Checks if it's needed to load knowledge object associated to the given id.
 */
export function checkKnowledgeLoading(id) {
    const data = findById.call(this, id);
    if (!data.viewed) {
        data.viewed = true;
        displayKnowledgePopup.call(this, data);
    }
}

/**
 * Displays knowledge on menu and on popup.
 */
function displayKnowledgePopup(knowledge) {
    //Add new knowledge to side menu
    const hudScene = this.scene.get("hudScene");
    hudScene.menuData.push({
        id: knowledge.content.title,
        color: 0xADF12D,
        selected: false
    });
    if(hudScene.menuTable) hudScene.menuTable.refresh();

    //Display knowledge dialog popup
    const dialogScene = this.scene.get("dialogScene");
    dialogScene.createEventKnowledgeDialog(knowledge);
}

/**
 * Finds knowledge object by its id.
 */
export function findById(id) {
    return knowledge.find(elem => elem.id === id);
}

/**
 * Finds knowledge object by its title.
 */
export function findByTitle(title) {
    return knowledge.find(elem => elem.content.title === title);
}
